---
layout: post
title: "[Pandas]Column과 Row Indexing"
date: 2021-01-16
category: [Pandas]
excerpt: "Dataframe에서 column, row 조작, indexing"
tags: [column, row, index, indexing]
comments: true
---

## Column

**groupby함수로 묶으면 df으로 나옴**

```python
region = df1.groupby('시도').sum()
```
**데이터 프레임의 한 column을 array로 바꾸기**
```python
df[['column']].to_numpy()                                  #겹괄호 주의
```
**시리즈를 array로 바꾸기**
```python
s.to_numpy()
```
```python
subset = pd.crosstab(index,column)
df에서 crosstab으로 보고 싶은 column 뽑아서 index, column에 넣기
```
**column이름 보기**
```python
for col in data.columns: 
    print(col) 
```
**row mean: axis =1**
```python
df['mean'] = df.mean(axis=1)
df.drop('Region', axis=1).apply(lambda x: x.mean(), axis=1)   #Region 열은 숫자가 아니어서 빼고 계산
```

## Index



## Multiple index
```python
df1 = pd.DataFrame({'a': [art, art, art, science,science, history, history, history], 'b': [1, 1, 2, 1, 2, 1,2,1], 'c': [5,3,3,34,6, 12, 13,4]}
  a       b   c
0 art     1   5
1 art     1   3
2 art     2   3
3 science 1   34
4 science 2   6
5 history 1   12
6 history 2   13
7 history 1   4
```
**groupby 함수로 멀티 인덱스 만들기**
```python
df2 = df1.groupby(['a','b']).sum()
df2
a       b     c
art     1     8
        2     3
science 1     34
        2     6
history 1     16
        2     13

>>이렇게 하면 df2는 a,b 멀티 인덱스를 갖는 df가 됨
```

**Unstack(인덱스의 컬럼화):**
b 인덱스를 column name으로 보내서 멀티 column이 됨(멀티 column이 맞는 말인지는 모르겠음 )
```python
table = df2.unstack(level=-1, fill_value=None)
table
         c
b        1      2
a
art      8      3
science  34     6
history  16     13
```

**flattening hierachical index in columns :column이 (b, c) 이런 벡터형태로 나와서 column level를 줄임**

```python
table.columns = table.columns.get_level_values(1)     #만약에 0이었으면 b아닌 c가 살아남았을 듯
table
b        1      2
a
art      8      3
science  34     6
history  16     13
>>정상적인 column으로 작동함
```

* 참고: https://data-make.tistory.com/126

---

그외..

```python
#유일한 값 찾기
series.unique() #series 안에 있는 값들 종류별로 하나씩 나옴

#value별로 개수 세기 
series.value_counts(normalize, sort, ascending, bins, dropna)

#value 별 상대적 비율
series.value_counts(normalize=True)

#bins group별 값 세기
series.value_counts(bins=[0,1,2 등 값 종류], sort=True)

```

